# Fairino FR5 — Trajectory Replayer

Replays a previously recorded joint-space trajectory from a CSV file onto the Fairino FR5 robot.

---

## Prerequisites

- Windows PC on the same network as the FR5 (default IP: `192.168.58.2`)
- Fairino Windows SDK installed (`fairino` package importable)
- Python 3.x (native Windows or WSL)
- A trajectory CSV file (generated by `fairino_xbox_windows.py` or compatible source)

---

## Usage

```
python fairino_trajectory_replay.py [--file <csv>] [--speed <pct>]
```

### Arguments

| Argument | Default | Description |
|----------|---------|-------------|
| `--file` | `trajectory_log.csv` | Path to the trajectory CSV file |
| `--speed` | `30` | Starting playback speed (5–100%) |

### Examples

```bash
# Replay default file at default speed
python fairino_trajectory_replay.py

# Replay a specific file at 50% speed
python fairino_trajectory_replay.py --file my_traj.csv --speed 50
```

---

## CSV Format

The input CSV must have the following columns (as produced by `fairino_xbox_windows.py`):

```
timestamp, j1, j2, j3, j4, j5, j6
```

- `timestamp` — Unix timestamp (float), used for ordering only
- `j1`–`j6` — Joint angles in degrees

---

## Runtime Controls

Once playback begins, use keyboard input in the terminal:

| Key | Action |
|-----|--------|
| `↑` Up arrow | Increase speed by 5% |
| `↓` Down arrow | Decrease speed by 5% |
| `q` or `Q` | Stop playback |
| `Ctrl-C` | Abort immediately |

Speed is clamped between **5%** and **100%**. Speed changes apply immediately via `SetSpeed()` on the robot controller — effective even mid-motion.

---

## Execution Flow

1. CSV is loaded and downsampled (consecutive waypoints with < 0.3 deg change on all joints are dropped).
2. Robot connects to `192.168.58.2`.
3. Press **ENTER** to confirm move to the first waypoint.
4. After a 2-second settle, full replay begins waypoint-by-waypoint using `MoveJ`.
5. Between each waypoint the script waits the recorded time interval, polling for keypresses every 10 ms.
6. On exit (key or Ctrl-C), `ImmStopJOG` is called to halt motion.

---

## Safety Notes

- Always ensure the robot's workspace is clear before pressing ENTER.
- The script moves to the **first recorded waypoint** before replay — verify this is safe from the robot's current pose.
- Use `--speed 10` or lower for first-time playback of an unfamiliar trajectory.
- Emergency stop: press `q` or `Ctrl-C` at any time.
